import random
from aiogram import Bot, Dispatcher, executor, types

# ‚ö†Ô∏è –ó–ê–ú–ï–ù–ò–¢–ï –≠–¢–û–¢ –¢–û–ö–ï–ù –ù–ê –°–í–û–ô –û–¢ @BotFather!
API_TOKEN = 8293141398:AAGxHUnKZH21bqkiISmIv5rGVrfop1uwMMQ

# –°–ø–∏—Å–æ–∫ –∫–∞—Ä—Ç –¢–∞—Ä–æ (–ú–∞–∂–æ—Ä–Ω—ã–π –∞—Ä–∫–∞–Ω)
TAROT_CARDS = [
    "–®—É—Ç", "–ú–∞–≥", "–ñ—Ä–∏—Ü–∞", "–ò–º–ø–µ—Ä–∞—Ç—Ä–∏—Ü–∞", "–ò–º–ø–µ—Ä–∞—Ç–æ—Ä", "–ñ—Ä–µ—Ü", "–í–ª—é–±–ª—ë–Ω–Ω—ã–µ",
    "–ö–æ–ª–µ—Å–Ω–∏—Ü–∞", "–°–∏–ª–∞", "–û—Ç—à–µ–ª—å–Ω–∏–∫", "–ö–æ–ª–µ—Å–æ –§–æ—Ä—Ç—É–Ω—ã", "–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å",
    "–ü–æ–≤–µ—à–µ–Ω–Ω—ã–π", "–°–º–µ—Ä—Ç—å", "–£–º–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å", "–î—å—è–≤–æ–ª", "–ë–∞—à–Ω—è", "–ó–≤–µ–∑–¥–∞",
    "–õ—É–Ω–∞", "–°–æ–ª–Ω—Ü–µ", "–°—É–¥", "–ú–∏—Ä"
]

# –°–æ–∑–¥–∞—ë–º –±–æ—Ç–∞ –∏ –¥–∏—Å–ø–µ—Ç—á–µ—Ä
bot = Bot(token=API_TOKEN)
dp = Dispatcher(bot)

# –ü–∞–º—è—Ç—å: –∫—Ç–æ —É–∂–µ –ø–æ–ª—É—á–∏–ª –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Ä–∞—Å–∫–ª–∞–¥ (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö)
used_users = set()

# –ö–æ–º–∞–Ω–¥–∞ /start
@dp.message_handler(commands=['start'])
async def send_welcome(message: types.Message):
    await message.reply(
        "üîÆ –ü—Ä–∏–≤–µ—Ç! –Ø ‚Äî –º–∞–≥ –¢–∞—Ä–æ.\n\n"
        "–ü–µ—Ä–≤—ã–π —Ä–∞—Å–∫–ª–∞–¥ ‚Äî –±–µ—Å–ø–ª–∞—Ç–Ω–æ! –ù–∞–ø–∏—à–∏ /tarot, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å."
    )

# –ö–æ–º–∞–Ω–¥–∞ /tarot ‚Äî –¥–µ–ª–∞–µ—Ç —Ä–∞—Å–∫–ª–∞–¥
@dp.message_handler(commands=['tarot'])
async def do_tarot(message: types.Message):
    user_id = message.from_user.id

    if user_id not in used_users:
        # –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Ä–∞—Å–∫–ª–∞–¥
        cards = random.sample(TAROT_CARDS, 3)
        response = f"‚ú® –¢–≤–æ–π –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Ä–∞—Å–∫–ª–∞–¥:\n\n1. {cards[0]}\n2. {cards[1]}\n3. {cards[2]}\n\n"
        response += "üîÆ –ó–Ω–∞—á–µ–Ω–∏–µ: –¥–æ–≤–µ—Ä—å—Å—è –∏–Ω—Ç—É–∏—Ü–∏–∏, –ø–µ—Ä–µ–º–µ–Ω—ã –Ω–µ–∏–∑–±–µ–∂–Ω—ã, –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä—è–¥–æ–º.\n\n"
        response += "–°–ª–µ–¥—É—é—â–∏–µ —Ä–∞—Å–∫–ª–∞–¥—ã ‚Äî 150 ‚ÇΩ. –ù–∞–ø–∏—à–∏ /pay, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å!"
        used_users.add(user_id)
        await message.answer(response)
    else:
        # –ü–ª–∞—Ç–Ω—ã–π —Ä–∞—Å–∫–ª–∞–¥
        await message.answer(
            "ü™ô –°–ª–µ–¥—É—é—â–∏–µ —Ä–∞—Å–∫–ª–∞–¥—ã —Å—Ç–æ—è—Ç 150 ‚ÇΩ.\n\n"
            "–û–ø–ª–∞—Ç–∏ –ø–æ —Å—Å—ã–ª–∫–µ: https://example.com/pay\n\n"
            "–ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã –Ω–∞–ø–∏—à–∏ –º–Ω–µ ‚Äî —è –ø—Ä–æ–≤–µ—Ä—é –∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É—é –¥–æ—Å—Ç—É–ø!"
        )

# –ö–æ–º–∞–Ω–¥–∞ /pay ‚Äî –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –æ–ø–ª–∞—Ç–µ
@dp.message_handler(commands=['pay'])
async def send_payment_info(message: types.Message):
    await message.answer(
        "üí≥ –û–ø–ª–∞—Ç–∏ 150 ‚ÇΩ –∑–¥–µ—Å—å:\nhttps://example.com/pay\n\n"
        "–ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã –Ω–∞–ø–∏—à–∏ @–≤–∞—à_–Ω–∏–∫ ‚Äî —è –≤–∫–ª—é—á—É –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø!"
    )

# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
if __name__ == '__main__':
    print("‚úÖ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!")
    executor.start_polling(dp, skip_updates=True)
